


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=windows-1252"> 
  <title>Coverage Report > AbstractAsymmetricJwkBuilder</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">io.jsonwebtoken.impl.security</a>
</div>

<h1>Coverage Summary for Class: AbstractAsymmetricJwkBuilder (io.jsonwebtoken.impl.security)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">AbstractAsymmetricJwkBuilder</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (11/11)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (28/28)
  </span>
</td>
</tr>
  <tr>
    <td class="name">AbstractAsymmetricJwkBuilder$DefaultEcPrivateJwkBuilder</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractAsymmetricJwkBuilder$DefaultEcPublicJwkBuilder</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractAsymmetricJwkBuilder$DefaultOctetPrivateJwkBuilder</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (5/5)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractAsymmetricJwkBuilder$DefaultOctetPublicJwkBuilder</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (3/3)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractAsymmetricJwkBuilder$DefaultPrivateJwkBuilder</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (3/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (5/5)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractAsymmetricJwkBuilder$DefaultPublicJwkBuilder</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (4/4)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractAsymmetricJwkBuilder$DefaultRsaPrivateJwkBuilder</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">AbstractAsymmetricJwkBuilder$DefaultRsaPublicJwkBuilder</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (2/2)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (28/28)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (53/53)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/*
&nbsp; * Copyright (C) 2021 jsonwebtoken.io
&nbsp; *
&nbsp; * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
&nbsp; * you may not use this file except in compliance with the License.
&nbsp; * You may obtain a copy of the License at
&nbsp; *
&nbsp; *     http://www.apache.org/licenses/LICENSE-2.0
&nbsp; *
&nbsp; * Unless required by applicable law or agreed to in writing, software
&nbsp; * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
&nbsp; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
&nbsp; * See the License for the specific language governing permissions and
&nbsp; * limitations under the License.
&nbsp; */
&nbsp;package io.jsonwebtoken.impl.security;
&nbsp;
&nbsp;import io.jsonwebtoken.impl.ParameterMap;
&nbsp;import io.jsonwebtoken.lang.Assert;
&nbsp;import io.jsonwebtoken.security.AsymmetricJwk;
&nbsp;import io.jsonwebtoken.security.AsymmetricJwkBuilder;
&nbsp;import io.jsonwebtoken.security.EcPrivateJwk;
&nbsp;import io.jsonwebtoken.security.EcPrivateJwkBuilder;
&nbsp;import io.jsonwebtoken.security.EcPublicJwk;
&nbsp;import io.jsonwebtoken.security.EcPublicJwkBuilder;
&nbsp;import io.jsonwebtoken.security.MalformedKeyException;
&nbsp;import io.jsonwebtoken.security.OctetPrivateJwk;
&nbsp;import io.jsonwebtoken.security.OctetPrivateJwkBuilder;
&nbsp;import io.jsonwebtoken.security.OctetPublicJwk;
&nbsp;import io.jsonwebtoken.security.OctetPublicJwkBuilder;
&nbsp;import io.jsonwebtoken.security.PrivateJwk;
&nbsp;import io.jsonwebtoken.security.PrivateJwkBuilder;
&nbsp;import io.jsonwebtoken.security.PublicJwk;
&nbsp;import io.jsonwebtoken.security.PublicJwkBuilder;
&nbsp;import io.jsonwebtoken.security.RsaPrivateJwk;
&nbsp;import io.jsonwebtoken.security.RsaPrivateJwkBuilder;
&nbsp;import io.jsonwebtoken.security.RsaPublicJwk;
&nbsp;import io.jsonwebtoken.security.RsaPublicJwkBuilder;
&nbsp;
&nbsp;import java.net.URI;
&nbsp;import java.security.Key;
&nbsp;import java.security.PrivateKey;
&nbsp;import java.security.PublicKey;
&nbsp;import java.security.cert.X509Certificate;
&nbsp;import java.security.interfaces.ECPrivateKey;
&nbsp;import java.security.interfaces.ECPublicKey;
&nbsp;import java.security.interfaces.RSAPrivateKey;
&nbsp;import java.security.interfaces.RSAPublicKey;
&nbsp;import java.util.List;
&nbsp;
<b class="fc">&nbsp;abstract class AbstractAsymmetricJwkBuilder&lt;K extends Key, J extends AsymmetricJwk&lt;K&gt;, T extends AsymmetricJwkBuilder&lt;K, J, T&gt;&gt;</b>
&nbsp;        extends AbstractJwkBuilder&lt;K, J, T&gt; implements AsymmetricJwkBuilder&lt;K, J, T&gt; {
&nbsp;
<b class="fc">&nbsp;    protected Boolean applyX509KeyUse = null;</b>
<b class="fc">&nbsp;    private KeyUseStrategy keyUseStrategy = DefaultKeyUseStrategy.INSTANCE;</b>
&nbsp;
&nbsp;    private final X509BuilderSupport x509;
&nbsp;
&nbsp;    public AbstractAsymmetricJwkBuilder(JwkContext&lt;K&gt; ctx) {
<b class="fc">&nbsp;        super(ctx);</b>
<b class="fc">&nbsp;        ParameterMap map = Assert.isInstanceOf(ParameterMap.class, this.DELEGATE);</b>
<b class="fc">&nbsp;        this.x509 = new X509BuilderSupport(map, MalformedKeyException.class);</b>
&nbsp;    }
&nbsp;
&nbsp;    AbstractAsymmetricJwkBuilder(AbstractAsymmetricJwkBuilder&lt;?, ?, ?&gt; b, JwkContext&lt;K&gt; ctx) {
<b class="fc">&nbsp;        this(ctx);</b>
<b class="fc">&nbsp;        this.applyX509KeyUse = b.applyX509KeyUse;</b>
<b class="fc">&nbsp;        this.keyUseStrategy = b.keyUseStrategy;</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public T publicKeyUse(String use) {
<b class="fc">&nbsp;        Assert.hasText(use, &quot;publicKeyUse cannot be null or empty.&quot;);</b>
<b class="fc">&nbsp;        this.DELEGATE.setPublicKeyUse(use);</b>
<b class="fc">&nbsp;        return self();</b>
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;    public T setKeyUseStrategy(KeyUseStrategy strategy) {
&nbsp;        this.keyUseStrategy = Assert.notNull(strategy, &quot;KeyUseStrategy cannot be null.&quot;);
&nbsp;        return tthis();
&nbsp;    }
&nbsp;     */
&nbsp;
&nbsp;    @Override
&nbsp;    public T x509Chain(List&lt;X509Certificate&gt; chain) {
<b class="fc">&nbsp;        Assert.notEmpty(chain, &quot;X509Certificate chain cannot be null or empty.&quot;);</b>
<b class="fc">&nbsp;        this.x509.x509Chain(chain);</b>
<b class="fc">&nbsp;        return self();</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public T x509Url(URI uri) {
<b class="fc">&nbsp;        Assert.notNull(uri, &quot;X509Url cannot be null.&quot;);</b>
<b class="fc">&nbsp;        this.x509.x509Url(uri);</b>
<b class="fc">&nbsp;        return self();</b>
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;    @Override
&nbsp;    public T withX509KeyUse(boolean enable) {
&nbsp;        this.applyX509KeyUse = enable;
&nbsp;        return tthis();
&nbsp;    }
&nbsp;     */
&nbsp;
&nbsp;    @Override
&nbsp;    public T x509Sha1Thumbprint(byte[] thumbprint) {
<b class="fc">&nbsp;        this.x509.x509Sha1Thumbprint(thumbprint);</b>
<b class="fc">&nbsp;        return self();</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public T x509Sha256Thumbprint(byte[] thumbprint) {
<b class="fc">&nbsp;        this.x509.x509Sha256Thumbprint(thumbprint);</b>
<b class="fc">&nbsp;        return self();</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public T x509Sha1Thumbprint(boolean enable) {
<b class="fc">&nbsp;        this.x509.x509Sha1Thumbprint(enable);</b>
<b class="fc">&nbsp;        return self();</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public T x509Sha256Thumbprint(boolean enable) {
<b class="fc">&nbsp;        this.x509.x509Sha256Thumbprint(enable);</b>
<b class="fc">&nbsp;        return self();</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public J build() {
<b class="fc">&nbsp;        this.x509.apply();</b>
<b class="fc">&nbsp;        return super.build();</b>
&nbsp;    }
&nbsp;
&nbsp;    private abstract static class DefaultPublicJwkBuilder&lt;K extends PublicKey, L extends PrivateKey,
&nbsp;            J extends PublicJwk&lt;K&gt;, M extends PrivateJwk&lt;L, K, J&gt;, P extends PrivateJwkBuilder&lt;L, K, J, M, P&gt;,
&nbsp;            T extends PublicJwkBuilder&lt;K, L, J, M, P, T&gt;&gt;
&nbsp;            extends AbstractAsymmetricJwkBuilder&lt;K, J, T&gt;
&nbsp;            implements PublicJwkBuilder&lt;K, L, J, M, P, T&gt; {
&nbsp;
&nbsp;        DefaultPublicJwkBuilder(JwkContext&lt;K&gt; ctx) {
<b class="fc">&nbsp;            super(ctx);</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public P privateKey(L privateKey) {
<b class="fc">&nbsp;            Assert.notNull(privateKey, &quot;PrivateKey argument cannot be null.&quot;);</b>
<b class="fc">&nbsp;            final K publicKey = Assert.notNull(DELEGATE.getKey(), &quot;PublicKey cannot be null.&quot;);</b>
<b class="fc">&nbsp;            return newPrivateBuilder(newContext(privateKey)).publicKey(publicKey);</b>
&nbsp;        }
&nbsp;
&nbsp;        protected abstract P newPrivateBuilder(JwkContext&lt;L&gt; ctx);
&nbsp;    }
&nbsp;
&nbsp;    private abstract static class DefaultPrivateJwkBuilder&lt;K extends PrivateKey, L extends PublicKey,
&nbsp;            J extends PublicJwk&lt;L&gt;, M extends PrivateJwk&lt;K, L, J&gt;,
&nbsp;            T extends PrivateJwkBuilder&lt;K, L, J, M, T&gt;&gt;
&nbsp;            extends AbstractAsymmetricJwkBuilder&lt;K, M, T&gt;
&nbsp;            implements PrivateJwkBuilder&lt;K, L, J, M, T&gt; {
&nbsp;
&nbsp;        DefaultPrivateJwkBuilder(JwkContext&lt;K&gt; ctx) {
<b class="fc">&nbsp;            super(ctx);</b>
&nbsp;        }
&nbsp;
&nbsp;        DefaultPrivateJwkBuilder(DefaultPublicJwkBuilder&lt;L, K, J, M, ?, ?&gt; b, JwkContext&lt;K&gt; ctx) {
<b class="fc">&nbsp;            super(b, ctx);</b>
<b class="fc">&nbsp;            this.DELEGATE.setPublicKey(b.DELEGATE.getKey());</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        public T publicKey(L publicKey) {
<b class="fc">&nbsp;            this.DELEGATE.setPublicKey(publicKey);</b>
<b class="fc">&nbsp;            return self();</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    static class DefaultRsaPublicJwkBuilder
&nbsp;            extends DefaultPublicJwkBuilder&lt;RSAPublicKey, RSAPrivateKey, RsaPublicJwk, RsaPrivateJwk, RsaPrivateJwkBuilder, RsaPublicJwkBuilder&gt;
&nbsp;            implements RsaPublicJwkBuilder {
&nbsp;
&nbsp;        DefaultRsaPublicJwkBuilder(JwkContext&lt;RSAPublicKey&gt; ctx) {
<b class="fc">&nbsp;            super(ctx);</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        protected RsaPrivateJwkBuilder newPrivateBuilder(JwkContext&lt;RSAPrivateKey&gt; ctx) {
<b class="fc">&nbsp;            return new DefaultRsaPrivateJwkBuilder(this, ctx);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    static class DefaultEcPublicJwkBuilder
&nbsp;            extends DefaultPublicJwkBuilder&lt;ECPublicKey, ECPrivateKey, EcPublicJwk, EcPrivateJwk, EcPrivateJwkBuilder, EcPublicJwkBuilder&gt;
&nbsp;            implements EcPublicJwkBuilder {
&nbsp;        DefaultEcPublicJwkBuilder(JwkContext&lt;ECPublicKey&gt; src) {
<b class="fc">&nbsp;            super(src);</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        protected EcPrivateJwkBuilder newPrivateBuilder(JwkContext&lt;ECPrivateKey&gt; ctx) {
<b class="fc">&nbsp;            return new DefaultEcPrivateJwkBuilder(this, ctx);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    static class DefaultOctetPublicJwkBuilder&lt;A extends PublicKey, B extends PrivateKey&gt;
&nbsp;            extends DefaultPublicJwkBuilder&lt;A, B, OctetPublicJwk&lt;A&gt;, OctetPrivateJwk&lt;B, A&gt;,
&nbsp;            OctetPrivateJwkBuilder&lt;B, A&gt;, OctetPublicJwkBuilder&lt;A, B&gt;&gt;
&nbsp;            implements OctetPublicJwkBuilder&lt;A, B&gt; {
&nbsp;        DefaultOctetPublicJwkBuilder(JwkContext&lt;A&gt; ctx) {
<b class="fc">&nbsp;            super(ctx);</b>
<b class="fc">&nbsp;            EdwardsCurve.assertEdwards(ctx.getKey());</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        protected OctetPrivateJwkBuilder&lt;B, A&gt; newPrivateBuilder(JwkContext&lt;B&gt; ctx) {
<b class="fc">&nbsp;            return new DefaultOctetPrivateJwkBuilder&lt;&gt;(this, ctx);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    static class DefaultRsaPrivateJwkBuilder
&nbsp;            extends DefaultPrivateJwkBuilder&lt;RSAPrivateKey, RSAPublicKey, RsaPublicJwk, RsaPrivateJwk, RsaPrivateJwkBuilder&gt;
&nbsp;            implements RsaPrivateJwkBuilder {
&nbsp;        DefaultRsaPrivateJwkBuilder(JwkContext&lt;RSAPrivateKey&gt; src) {
<b class="fc">&nbsp;            super(src);</b>
&nbsp;        }
&nbsp;
&nbsp;        DefaultRsaPrivateJwkBuilder(DefaultRsaPublicJwkBuilder b, JwkContext&lt;RSAPrivateKey&gt; ctx) {
<b class="fc">&nbsp;            super(b, ctx);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    static class DefaultEcPrivateJwkBuilder
&nbsp;            extends DefaultPrivateJwkBuilder&lt;ECPrivateKey, ECPublicKey, EcPublicJwk, EcPrivateJwk, EcPrivateJwkBuilder&gt;
&nbsp;            implements EcPrivateJwkBuilder {
&nbsp;        DefaultEcPrivateJwkBuilder(JwkContext&lt;ECPrivateKey&gt; src) {
<b class="fc">&nbsp;            super(src);</b>
&nbsp;        }
&nbsp;
&nbsp;        DefaultEcPrivateJwkBuilder(DefaultEcPublicJwkBuilder b, JwkContext&lt;ECPrivateKey&gt; ctx) {
<b class="fc">&nbsp;            super(b, ctx);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    static class DefaultOctetPrivateJwkBuilder&lt;A extends PrivateKey, B extends PublicKey&gt;
&nbsp;            extends DefaultPrivateJwkBuilder&lt;A, B, OctetPublicJwk&lt;B&gt;, OctetPrivateJwk&lt;A, B&gt;,
&nbsp;            OctetPrivateJwkBuilder&lt;A, B&gt;&gt; implements OctetPrivateJwkBuilder&lt;A, B&gt; {
&nbsp;        DefaultOctetPrivateJwkBuilder(JwkContext&lt;A&gt; src) {
<b class="fc">&nbsp;            super(src);</b>
<b class="fc">&nbsp;            EdwardsCurve.assertEdwards(src.getKey());</b>
&nbsp;        }
&nbsp;
&nbsp;        DefaultOctetPrivateJwkBuilder(DefaultOctetPublicJwkBuilder&lt;B, A&gt; b, JwkContext&lt;A&gt; ctx) {
<b class="fc">&nbsp;            super(b, ctx);</b>
<b class="fc">&nbsp;            EdwardsCurve.assertEdwards(ctx.getKey());</b>
<b class="fc">&nbsp;            EdwardsCurve.assertEdwards(ctx.getPublicKey());</b>
&nbsp;        }
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-11-02 22:24</div>
</div>
</body>
</html>
